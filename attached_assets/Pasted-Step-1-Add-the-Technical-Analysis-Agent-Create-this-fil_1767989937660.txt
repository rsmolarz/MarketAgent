Step 1 — Add the Technical Analysis Agent

Create this file:

agents/technical_analysis_agent.py
from typing import List, Dict, Any
from .base_agent import BaseAgent
from data_sources.yahoo_finance_client import YahooFinanceClient
from ta.signals import generate_signals

class TechnicalAnalysisAgent(BaseAgent):
    """
    Core Technical Analysis Agent
    Produces RSI / MACD / MA / Bollinger / Support-Resistance signals
    """

    def __init__(self):
        super().__init__()
        self.yahoo = YahooFinanceClient()
        self.symbols = self.config.get(
            "symbols",
            ["SPY", "QQQ", "IWM", "DIA", "TLT", "GLD", "BTC-USD"]
        )
        self.period = self.config.get("period", "6mo")

    def analyze(self) -> List[Dict[str, Any]]:
        findings = []

        for symbol in self.symbols:
            df = self.yahoo.get_price_data(symbol, period=self.period)
            if df is None or df.empty or len(df) < 60:
                continue

            signals, ta = generate_signals(symbol, df)

            for s in signals:
                severity = "medium" if s["confidence"] >= 0.6 else "low"

                findings.append(self.create_finding(
                    title=f"TA Signal: {s['type']} on {symbol}",
                    description=f"{symbol} technical signal detected ({s['bias']}). "
                                f"RSI={ta['rsi']:.1f}, MA20={ta['ma20']:.2f}, MA50={ta['ma50']:.2f}",
                    severity=severity,
                    confidence=float(s.get("confidence", 0.5)),
                    symbol=symbol,
                    market_type="technical",
                    metadata={
                        "signal": s,
                        "ta_snapshot": ta
                    }
                ))

        return findings

    # Backtest-compatible
    def analyze_ctx(self, ctx) -> List[Dict[str, Any]]:
        findings = []

        for symbol in self.symbols:
            df = ctx.frame(symbol)
            if df is None or df.empty or len(df) < 60:
                continue

            signals, ta = generate_signals(symbol, df)

            for s in signals:
                findings.append(self.create_finding(
                    title=f"TA Signal: {s['type']} on {symbol}",
                    description=f"{symbol} TA signal ({s['bias']})",
                    severity="medium",
                    confidence=float(s.get("confidence", 0.5)),
                    symbol=symbol,
                    market_type="technical",
                    metadata={
                        "signal": s,
                        "ta_snapshot": ta,
                        "asof": ctx.asof.isoformat()
                    }
                ))

        return findings

Step 2 — Register the Agent (THIS FILE)

In the file you pasted, make two small changes.

✅ 2.1 Add to AVAILABLE_AGENTS

Append this string:

'TechnicalAnalysisAgent'


So the end becomes:

    'DailyPredictionAgent',
    'CryptoPredictionAgent',
    'TechnicalAnalysisAgent'
]

✅ 2.2 Import is NOT required

You do not need to add a manual import at the top
(importlib + naming convention already handles it).

Your loader will resolve:

TechnicalAnalysisAgent
→ agents.technical_analysis_agent


Correctly.

Step 3 — Add schedule entry

In agent_schedule.json:

"TechnicalAnalysisAgent": {
  "interval": 30,
  "enabled": true,
  "weight": 1.0,
  "reason": "core_ta"
}


This lets:

Meta-Agent rank it

Regime rotation weight it

Allocator fade it with decay + uncertainty

Step 4 — What you now have (important)

With this one agent, your platform gains:

✅ Live TA signals

RSI overbought/oversold

MACD momentum shifts

Trend filter (MA20 / MA50)

Support / resistance proximity

✅ Backtesting from 2007+

Fully compatible with analyze_ctx

No network calls

Works with your evaluation engine

✅ LLM-ready inputs

Your Claude / GPT / Gemini council now gets:

Explicit RSI levels

MA relationships

Concrete entry/exit context

This dramatically improves signal quality and reduces hallucination.